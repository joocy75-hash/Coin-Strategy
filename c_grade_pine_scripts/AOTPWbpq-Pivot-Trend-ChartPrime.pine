//Â ThisÂ PineÂ Scriptâ„¢Â codeÂ isÂ subjectÂ toÂ theÂ termsÂ ofÂ theÂ MozillaÂ PublicÂ LicenseÂ 2.0Â atÂ https://mozilla.org/MPL/2.0/
//Â Â©Â ChartPrime

//@version=6
indicator('PivotÂ TrendÂ [ChartPrime]',Â overlayÂ =Â true)

//Â ğ™ğ™ğ™€ğ™Â ğ™„ğ™‰ğ™‹ğ™ğ™ğ™
intÂ left_barsÂ =Â input(10,Â 'LeftÂ Bars',Â groupÂ =Â 'PivotÂ Settings')
intÂ right_barsÂ =Â input(10,Â 'RightÂ Bars',Â groupÂ =Â 'PivotÂ Settings')
floatÂ OffsetÂ =Â input.float(2,Â stepÂ =Â 0.01)


//Â ğ™„ğ™‰ğ˜¿ğ™„ğ˜¾ğ˜¼ğ™ğ™Šğ™Â ğ˜¾ğ˜¼ğ™‡ğ˜¾ğ™ğ™‡ğ˜¼ğ™ğ™„ğ™Šğ™‰
varÂ floatÂ phyÂ =Â na
varÂ floatÂ plyÂ =Â na

atrÂ =Â ta.atr(200)

p_highÂ =Â ta.pivothigh(highÂ +Â atrÂ *Â Offset,Â left_bars,Â right_bars)
p_lowÂ =Â ta.pivotlow(lowÂ -Â atrÂ *Â Offset,Â left_bars,Â right_bars)

ifÂ bool(p_high)
Â Â Â Â phyÂ :=Â p_high
Â Â Â Â phy

ifÂ bool(p_low)
Â Â Â Â plyÂ :=Â p_low
Â Â Â Â ply

//Â TrendÂ 
upperBandÂ =Â phy
lowerBandÂ =Â ply

prevLowerBandÂ =Â nz(lowerBand[1])
prevUpperBandÂ =Â nz(upperBand[1])


intÂ trendÂ =Â na
floatÂ TrendÂ =Â na
prevTrendÂ =Â Trend[1]

ifÂ prevTrendÂ ==Â prevUpperBand
Â Â Â Â trendÂ :=Â closeÂ >Â upperBandÂ ?Â 1Â :Â -1
Â Â Â Â trend
else
Â Â Â Â trendÂ :=Â closeÂ <Â lowerBandÂ ?Â -1Â :Â 1
Â Â Â Â trend
TrendÂ :=Â trendÂ ==Â 1Â ?Â lowerBandÂ :Â trendÂ ==Â -1Â ?Â upperBandÂ :Â na


//Â ğ™‘ğ™„ğ™ğ™ğ˜¼ğ™‡ğ™„ğ™•ğ˜¼ğ™ğ™„ğ™Šğ™‰
//@Â Signals
colorÂ =Â trendÂ ==Â 1Â ?Â color.blueÂ :Â trendÂ ==Â -1Â ?Â color.redÂ :Â na
plotchar(ta.crossover(trend,Â 0)Â ?Â TrendÂ :Â na,Â 'Buy',Â 'ğŸ…‘',Â location.absolute,Â color.blue,Â sizeÂ =Â size.small)
plotchar(ta.crossunder(trend,Â 0)Â ?Â TrendÂ :Â na,Â 'Sell',Â 'ğŸ…¢',Â location.absolute,Â color.red,Â sizeÂ =Â size.small)
//@Â PivotÂ Trend
upTrendÂ =Â plot(trendÂ <Â 0Â ?Â TrendÂ :Â na,Â 'UpÂ Trend',Â colorÂ =Â color,Â styleÂ =Â plot.style_linebr)
downTrendÂ =Â plot(trendÂ <Â 0Â ?Â naÂ :Â Trend,Â 'DownÂ Trend',Â colorÂ =Â color,Â styleÂ =Â plot.style_linebr)

p1Â =Â plot(Trend,Â colorÂ =Â na)
p2Â =Â plot(hl2,Â colorÂ =Â na)
fill(p1,Â p2,Â Trend,Â hl2,Â color.new(color,Â 85),Â color.new(color,Â 99))



//Â ğŸ…¢Â ğŸ…‘