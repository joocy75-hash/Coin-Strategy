# 🏗️ 시스템 아키텍처

## 전체 파이프라인

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              데이터 수집                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│  TradingView  ──▶  Playwright Scraper  ──▶  SQLite DB                       │
│  (500+ 부스트)      (6시간마다 자동)         (strategies.db)                  │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              AI 분석                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│  Pine Parser (AST)  ──▶  Claude AI  ──▶  FinBERT  ──▶  등급 부여 (A~F)       │
│  (리페인팅 탐지)         (심층 분석)      (과대광고 탐지)                       │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              백테스트                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│  Pine → Python  ──▶  VectorBT Engine  ──▶  75개 데이터셋  ──▶  성과 리포트   │
│  (변환기)             (고속 백테스트)       (25심볼×3TF)                       │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              실전매매                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│  검증된 전략  ──▶  안전장치  ──▶  Binance API  ──▶  텔레그램 알림             │
│  (B등급 이상)      (손실제한)     (ccxt)            (거래 알림)                │
│                                                                              │
│  [선택] Freqtrade  ──▶  FreqAI (ML)  ──▶  강화학습 (RL)                      │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 핵심 컴포넌트

| 컴포넌트 | 파일 | 역할 |
|---------|------|------|
| API 서버 | `api/server.py` | REST API, 대시보드 |
| 수집기 | `src/collector/` | TradingView 스크래핑 |
| 분석기 | `src/analyzer/` | Claude AI, FinBERT, Pine Parser |
| 변환기 | `src/converter/` | Pine → Python |
| 백테스터 | `src/backtester/` | VectorBT 엔진 |
| 트레이딩 | `src/trading/` | 안전장치, 긴급정지 |
| 로깅 | `src/logging/` | 거래 로그, 감사 추적 |

## 배포 구조

```
141.164.55.245 (Hetzner Cloud)
├── Docker Compose
│   ├── strategy-lab (API 서버, 포트 8081)
│   └── strategy-scheduler (자동 수집)
├── Nginx (리버스 프록시)
└── GitHub Actions (자동 배포)
```

## 데이터 흐름

```
.env (환경변수)
    ├── ANTHROPIC_API_KEY ──▶ Claude AI 분석
    ├── BINANCE_API_KEY ──▶ 실전매매 (선택)
    └── TELEGRAM_BOT_TOKEN ──▶ 알림 (선택)
```
